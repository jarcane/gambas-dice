' Gambas class file

Public Num As Integer
Public Sides As Integer 
Public Modifier As Integer 
Public ModifierEnabled As Boolean

Private LastRoll As Integer[]

Public Sub _new(n As Integer, s As Integer, m As Integer, enabled As Boolean)
  
  Me.Num = n
  Me.Sides = s
  Me.Modifier = m
  Me.ModifierEnabled = enabled
  
End


Public Sub Roll()
  
  Let LastRoll = []
  
  For x As Integer = 1 To Num
    LastRoll.Push(Rand(1, Sides))
  Next
  
End

Public Function Total() As Integer
  
  Dim t As Integer = 0
  
  For Each x As Integer In LastRoll
    t += x
  Next
  
  If ModifierEnabled Then t += Modifier
  
  Return t
  
End

Public Function AllDice() As String
  
  Dim all As String = ""
  
  For Each x As Integer In LastRoll
    all &= Str(x) & " "
  Next
  
  Return all
  
End


Public Function AsString() As String
  Dim modAsString As String = ""
  
  If ModifierEnabled Then 
    If Modifier > 0 Then
        modAsString = "+" & Str(Modifier)
    Else If Modifier < 0 Then
      modAsString = Str(Modifier)
    Endif
  Endif 
  
  Return Str(Num) & "D" & Str(Sides) & modAsString
  
End

Public Function Copy() As DieRoll
  
  Return New DieRoll(Num, Sides, Modifier, ModifierEnabled)
  
End
