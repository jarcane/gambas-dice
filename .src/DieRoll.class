' Gambas class file

Public Num As Integer = 3
Public Sides As Integer = 6
Public Modifier As Integer = 0
Public ModifierEnabled As Boolean = False

Private LastRoll As Integer[]

Public Sub _new(Num As Integer, Sides As Integer, Modifier As Integer, ModifierEnabled As Boolean)
  
  Me.Num = Num
  Me.Sides = Sides
  Me.Modifier = Modifier
  Me.ModifierEnabled = ModifierEnabled
  
End


Public Sub Roll()
  
  Let LastRoll = []
  
  For x As Integer = 1 To Num
    LastRoll.Push(Rand(1, Sides))
  Next
  
End

Public Function Total() As Integer
  
  Dim total As Integer = 0
  
  For Each x As Integer In LastRoll
    total += x
  Next
  
  If ModifierEnabled Then total += Modifier
  
  Return total
  
End

Public Function AllDice() As String
  
  Dim all As String = ""
  
  For Each x As Integer In LastRoll
    all &= Str(x) & " "
  Next
  
  Return all
  
End


Public Function AsString() As String
  Dim modAsString As String = ""
  
  If ModifierEnabled Then 
    If Modifier > 0 Then
        modAsString = "+" & Str(Modifier)
    Else If Modifier < 0 Then
      modAsString = Str(Modifier)
    Endif
  Endif 
  
  Return Str(Num) & "D" & Str(Sides) & modAsString
  
End
