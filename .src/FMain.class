' Gambas class file

Public Current As DieRoll = New DieRoll(3, 6, 0, False)

Public Mem As DieRoll = New DieRoll(3, 6, 0, False)

Public Sub Form_Open()
  
  Randomize
  
End

Public Sub RollButton_Click()
  
  Current.Roll()
  
  FMain.Result.Text = Current.Total()
  FMain.AllDice.Text = Current.AllDice()
  FMain.HistoryLog.Text &= Current.AsString() & ": " & Current.AllDice() & "= " & Current.Total() & "\n"
  
End

Public Sub MemStore_Click()
  
  Mem = Current.Copy()
  
  FMain.HistoryLog.Text &= "Memory Stored: " & Mem.AsString() & "\n"
  
End

Public Sub MemRecall_Click()
  
  Current = Mem.Copy()
  
  FMain.HistoryLog.Text &= "Memory Recalled: " & Current.AsString() & "\n"
End

Public Sub NumDice_Change()

  Current.Num = NumDice.Value

End

Public Sub NumSides_Change()

  Current.Sides = NumSides.Value

End

Public Sub Modifier_Change()

  Current.Modifier = Modifier.Value

End

Public Sub ModifierEnabled_Click()

  Current.ModifierEnabled = ModifierEnabled.Value

End
